---
title: "Homework_5"
author: "Andrea_Sanchez_Hidalgo"
date: "2025-12-01"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, Part 1 README, eval=TRUE}
# Create README.md file from R

readme_text <- "

# Homework 5

This README file contain instructions for HW5. 

## Description
The purpose of this HW is learn to commmit to GIthub in R.

## Requirements or Packages

#library(dplyr)
#library(ggplot2)
#library(tidyr)
#library(tidyverse)
#library(lubridate)

## Bibliography
Some information was taken from Wikipedia and credit was given.

"

# Write the file to the project root
writeLines(readme_text, 'README.md')
```


```{r, Recreating a graph}
##It shows monthly homicides in Baltimore, with a reference added for the date of the arrest of Freddie Gray and color used to show colder months (November through April) versus warmer months (May through October). There is a smooth line added to help show seasonal and long-term trends in this data.

##Library load
library(dplyr)
library(ggplot2)
library(tidyr)
library(tidyverse)
library(lubridate)

##read file
getwd()
homicides <- read.csv ("https://raw.githubusercontent.com/AndreaSH15/EHRS-ASH/refs/heads/main/homicide-data.csv")

View(homicides)
str(homicides)

##extract infromation from Baltimore
homicides_baltimore <- homicides %>%
  filter(city == "Baltimore") %>%
  mutate(
    reported_date = ymd(reported_date),
    year = year(reported_date),
    month = month(reported_date),
    season = if_else(month %in% c(11,12,1,2,3,4), "colder", "warmer")
  ) %>%
  group_by(year, month, season, disposition) %>%
  summarise(homicides = n(), .groups = "drop")

homicides_baltimore_monthly <- homicides_baltimore %>%
  group_by(year, month, season) %>%
  summarise(total_homicides = sum(homicides), .groups = "drop")

View(homicides_baltimore)
```

##Freddie Gray

Interestingly, this database does not contain the name of Freddy Gray as a victim, however, according to Wikipedia, he was arrested on April 12, 2015, for possession of a knife, however, he was attacked by police officers on the same date and died in R Adams Cowley Shock Trauma Center. Gray's death on April 19, 2015, was ascribed to injuries to his cervical spinal cord. 

Source: https://en.wikipedia.org/wiki/Killing_of_Freddie_Gray

Note: As he was not in the data set obtained, the date of the arrest used on this exercise (April 12, 2015) was taken from Wikipedia.


```{r, Graph}

##Fix year of dataset
homicides_plotdata <- homicides_baltimore %>%
  mutate(
    date = ymd(paste(year, month, "01", sep = "-"))
  ) %>%
  group_by(date, season) %>%
  summarise(homicides = sum(homicides), .groups = "drop")

##Check
View(homicides_plotdata)

# Wikipedia Freddy Gray arrest
freddy_date <- ymd("2015-04-12") 

##Graph

ggplot(homicides_plotdata, aes(x = date, y = homicides)) +
  geom_col(aes(fill = season), alpha = 0.75) +
  geom_smooth(se = FALSE, color = "blue", size = 1.0, span = 0.1) +
  scale_fill_manual(values = c("colder" = "lightblue", "warmer" = "grey70")) +
  scale_x_date(date_breaks = "1 year", date_labels = "%Y") +
  labs(
    title = "Homicides in Baltimore",
    x = "Year",
    y = "Monthly homicides",
    fill = ""
  ) +
  theme_minimal(base_size = 13) +  # first apply theme_minimal
  theme(
    panel.background = element_rect(fill = "grey40", color = NA), # now this works
    legend.position = "bottom",
    panel.grid.minor = element_blank(),
    panel.grid.major.x = element_blank()
  ) +
  geom_vline(xintercept = freddy_date, color = "red", linetype = "dashed", size = 1) +
  # Add text label
  annotate("text", x = freddy_date, y = max(homicides_plotdata$homicides) * 0.95,
           label = "Arrest of Freddy Gray", color = "white", angle = 0, vjust = -0.1)
```


```

